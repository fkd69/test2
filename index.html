<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸©åº¦ã¨æ¹¿åº¦ã®ã‚°ãƒ©ãƒ•ï¼ˆCanvasJSï¼‰</title>
    <script src="https://cdn.canvasjs.com/canvasjs.min.js"></script> <!-- CanvasJSãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
</head>
<body>

    <div id="chartContainer" style="width: 80%; height: 500px; margin: auto;"></div>

    <script>
        // ğŸ”¹ Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®å…¬é–‹CSV URLï¼ˆçµ„ã¿è¾¼ã¿æ¸ˆã¿ï¼‰
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSY5A0PUveMgm9IHMFKvtNxzb_q1GhZ6pQd5ZIVCeDUUEmi6kpXmcLPrZd3s1VEez-rQzOWdopKBPIl/pub?gid=0&single=true&output=csv';

        // ğŸ”¹ CSVãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã‚°ãƒ©ãƒ•ã«è¡¨ç¤º
        fetch(sheetUrl)
            .then(response => response.text())
            .then(csvData => {
                const rows = csvData.split("\n").map(row => row.split(",")); // CSVã‚’é…åˆ—ã«å¤‰æ›

                // ğŸ“Œ ãƒ‡ãƒ¼ã‚¿ã®æ•´å½¢
                const temperatureData = [];  // æ¸©åº¦ãƒ‡ãƒ¼ã‚¿
                const humidityData = [];  // æ¹¿åº¦ãƒ‡ãƒ¼ã‚¿

                for (let i = 1; i < rows.length; i++) {  // 1è¡Œç›®ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ï¼‰ã¯ã‚¹ã‚­ãƒƒãƒ—
                    const row = rows[i];

                    // **ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯**
                    if (row.length < 3) continue;  // ç©ºè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—

                    const date = new Date(row[0]);  // æ—¥ä»˜ï¼ˆDateã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ï¼‰
                    const temperature = parseFloat(row[1]) || 0;  // æ¸©åº¦ãƒ‡ãƒ¼ã‚¿ï¼ˆNaNå¯¾ç­–ï¼‰
                    const humidity = parseFloat(row[2]) || 0;  // æ¹¿åº¦ãƒ‡ãƒ¼ã‚¿ï¼ˆNaNå¯¾ç­–ï¼‰

                    temperatureData.push({ x: date, y: temperature });
                    humidityData.push({ x: date, y: humidity });
                }

                console.log("æ¸©åº¦ãƒ‡ãƒ¼ã‚¿:", temperatureData);
                console.log("æ¹¿åº¦ãƒ‡ãƒ¼ã‚¿:", humidityData);

                // ğŸ”¹ CanvasJSã§ã‚°ãƒ©ãƒ•ã‚’æç”»
                const chart = new CanvasJS.Chart("chartContainer", {
                    animationEnabled: true,  // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æœ‰åŠ¹
                    zoomEnabled: true,       // ğŸ”¹ ã‚ºãƒ¼ãƒ ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ©Ÿèƒ½ï¼‰
                    panEnabled: true,        // ğŸ”¹ ãƒ‘ãƒ³ï¼ˆãƒ‰ãƒ©ãƒƒã‚°ã§ç§»å‹•ï¼‰
                    title: {
                        text: "æ¸©åº¦ã¨æ¹¿åº¦ã®æ¨ç§»"
                    },
                    axisX: {
                        title: "æ—¥ä»˜",
                        valueFormatString: "YYYY-MM-DD",  // Xè»¸ã®æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
                        labelAngle: -50  // ãƒ©ãƒ™ãƒ«ã®å‚¾ãèª¿æ•´
                    },
                    axisY: {
                        title: "æ¸©åº¦ (â„ƒ) / æ¹¿åº¦ (%)"
                    },
                    data: [
                        {
                            type: "spline",  // æ»‘ã‚‰ã‹ãªæ›²ç·š
                            name: "æ¸©åº¦ (â„ƒ)",
                            showInLegend: true,
                            markerSize: 5,
                            color: "red",
                            dataPoints: temperatureData
                        },
                        {
                            type: "spline",
                            name: "æ¹¿åº¦ (%)",
                            showInLegend: true,
                            markerSize: 5,
                            color: "blue",
                            dataPoints: humidityData
                        }
                    ]
                });

                chart.render();  // ã‚°ãƒ©ãƒ•ã‚’æç”»
            })
            .catch(error => console.error("ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:", error));
    </script>

</body>
</html>
